<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="author" content="Mauro Trevisan">
	<link rel="shortcut icon" href="../favicon.png" />

	<title>test</title>

	<script src="../app/AMDLoader.js"></script>

	<script>
		AMDLoader.config = {
			baseUrl: '../app',
			paths: {
				libs: '../libs'
			}
		};

		Array.prototype.getRegExp = function(){
			return (this[0].length == 1? '[' + this.join('') + ']': '(' + this.join('|') + ')');
		};
		Array.prototype.getNotRegExp = function(){
			return (this[0].length == 1? '[^' + this.join('') + ']': '(?!' + this.join('|') + ')');
		};
		Array.prototype.findIndex = function(predicate){
			for(var i = 0, len = this.length; i < len; i ++)
				if(predicate.call(this, this[i], i))
					return i;
			return -1;
		};
		Array.prototype.unique = function(){
			return this.filter(function(x, i){
				return (this.indexOf(x) == i);
			}, this);
		};
		Array.prototype.difference = function(a){
			return this.filter(function(x){
				return (a.indexOf(x) < 0);
			});
		};
		Array.prototype.equals = function(a){
			return (this.length == a.length && this.every(function(el){ return (a.indexOf(el) >= 0); }));
		};
		var intersection = function(a){
//			if(a == null)
//				return [];
//			if(arguments.length === 1)
//				return a.unique();
//
//			var arr = Array.prototype.concat.apply([], Array.prototype.slice.call(arguments, 1));
//
//			return a.unique().filter(function(el){
//				return arr.some(function(cur){
//					return (cur == el);
//				});
//			});

			var argsLength = arguments.length,
				length = a.length,
				result = [],
				i, j, item;
			for(i = 0; i < length; i ++){
				item = a[i];
				if(result.indexOf(item) >= 0)
					continue;

				for(j = 1; j < argsLength; j ++)
					if(arguments[j].indexOf(item) < 0)
						break;

				if(j == argsLength)
					result.push(item);
			}
			return result;
		};
		var partition = function(list, predicate){
			var result = {};
			list.forEach(function(value, index){
				var key = predicate(value, index, list);
				if(key in result)
					result[key].push(value);
				else
					result[key] = [value];
			});
			return result;
		};

		var composeInfinitive = (function(){
			var themeVowel = ['à', 'é', 'e', 'í', 'í'];

			return function(v){
				return v.prefix + v.radix + themeVowel[v.conjugation - 1] + 'r';
			};
		})();

		var applyReductions = function(list){
			epurateListAndApplyFlag(list, 'E',
				'e', 'i');
			epurateListAndApplyFlag(list, 'F',
				'a', 'e\/E');
			//T8: indikativo prexente, đontativo prexente
			epurateListAndApplyFlag(list, 'D',
				'o', 'a\/F');
			//T1: infenío sénplise
			epurateListAndApplyFlag(list, 'I',
				'r\/BG', 're');
			epurateListAndApplyFlag(list, 'J',
				'r', 're');
//7620
			//T2: indikativo inparfèto, đontativo inparfèto, partiŧipio ativo, xerundio sénplise
			epurateListAndApplyFlag(list, 'K',
				'[àèéí]vimo', '[àèéí]imo', '[àèéí]o\/D', '[aei]vo\/D',
				'[àèéí]simo', '[aei]se\/E',
				'[aei]sto\/D',
				'[aàeèéií]', '[aei]do\/D',
				'[aei]ndo\/BG');
/*			epurateListAndApplyFlag(list, 'L',
				'[àèéí]rimo', '[àèéí]imo', '[àèéí]o\/D', '[aei]vo\/D',
				'[àèéí]simo', '[aei]se\/E',
				'[aei]sto\/D',
				'[aàeèéií]', '[aei]do\/D',
				'[aei]ndo\/BG');
			//T4: indikativo futuro, kondiŧional prexente
/*			epurateListAndApplyFlag(list, 'J',
				'rò', 'rà', 'rè', 'ré', 'remo', 'ron', 'ren',
				'ría', 'ríe', 'résimo', 'ronse', 'rion', 'rionse', 'rison', 'risonse', 'rision', 'risionse', 'rense', 'risen', 'risense', 'resi', 'risié', 'rié',
				'rave');
			epurateListAndApplyFlag(list, 'K',
				'rò', 'rà', 'rè', 'ré', 'rí', 'remo', 'rimo', 'ron', 'ren',
				'ría', 'ríe', 'résimo', 'ronse', 'rion', 'rionse', 'rison', 'risonse', 'rision', 'risionse', 'rense', 'risen', 'risense', 'resi', 'risié', 'rié',
				'rave');
			//T5: indikativo prexente, đontativo prexente
			epurateListAndApplyFlag(list, 'L',
				'mo', '', 'de', 'ge');
			epurateListAndApplyFlag(list, 'M',
				'[aei]mo', '', 'è', 'í', 'ede', 'ege');
			//T6: partiŧipio pasivo
			epurateListAndApplyFlag(list, 'N',
				'do\/D', '', 'o\/D');
			//T7: partiŧipio ativo, partiŧipio pasivo, xerundio sénplise
			epurateListAndApplyFlag(list, 'O',
				'ndo\/BG', 'nte',
				'sto\/D');
			//T11: indikativo inparfèto, đontativo inparfèto
			epurateListAndApplyFlag(list, 'P',
				'on', 'ion', 'ionse', 'ivon', 'ivonse', 'ivion', 'ivionse', 'en', 'ense', 'iven', 'ivense', 'ié', 'ivié',
				'one', 'onse', 'ione', 'isone', 'isonse', 'isione', 'isionse', 'ene', 'isene', 'isense', 'iede', 'iege', 'isiede', 'isiege');
			//T12: indikativo prexente, đontativo prexente
			epurateListAndApplyFlag(list, 'Q',
				'on', 'one', 'ion', 'ione', 'en', 'ene', 'é', 'ede', 'iede', 'ege', 'iege');

/*			epurateListAndApplyFlag(list, 'L', 'ndo', 'ndo', 'nte', 'sto');
			epurateListAndApplyFlag(list, 'M', 'iso', 'iso', 'ise', 'isi');
			epurateListAndApplyFlag(list, 'N', 'isa', 'isa', 'ise', 'isi');
			epurateListAndApplyFlag(list, 'O', 'ndo', 'ndo', 'sto');
			epurateListAndApplyFlag(list, 'P', 'ison', 'ison', 'isé');

//			epurateListAndApplyFlag(list, 'H', 'e', 'e', 'se');
//			epurateListAndApplyFlag(list, 'G', 'n', 'n', 'ne/H');
//			epurateListAndApplyFlag(list, 'GL', 'on/G', 'on/G', 'emo', 'ion/G', 'en/G', 'iede', 'iege');
//			epurateListAndApplyFlag(list, 'M', 'ron', 'ron', 'remo', 'rave', 'ren', 'resi', 'rà', 'rè', 'ré', 'résimo', 'ría', 'ríe', 'rò');
//			epurateListAndApplyFlag(list, 'NH', 'ivon', 'ivon', 'ivion/H', 'iven/H', 'isié', 'ivié', 'ié');

/*			epurateListAndApplyFlag(list, 'D', 'o', 'o', 'a', 'e', 'i');
			epurateListAndApplyFlag(list, 'O', 'a/B', 'a/B', 'o/D');
			epurateListAndApplyFlag(list, 'E', 'e', 'e', 'i');
			epurateListAndApplyFlag(list, 'F', 'a', 'a', 'e/E');
			epurateListAndApplyFlag(list, 'GH', 'nse', 'n', 'ne', 'nse');
			epurateListAndApplyFlag(list, 'G', 'nse', 'n', 'nse');
			epurateListAndApplyFlag(list, 'I', 'a', '', 'a', 'e');
			epurateListAndApplyFlag(list, 'H', 'ne', 'n', 'ne');
			epurateListAndApplyFlag(list, 'J', '[àéí]', '', 'simo', 'vimo');
			epurateListAndApplyFlag(list, 'K', 'de', 'de', 'ge');
			epurateListAndApplyFlag(list, 'L', 'on/GH', 'on/GH', 'ede/K', 'sen/GH', 'siede/K', 'sié', 'sion/GH', 'son/GH', 'ven/G', 'vion/G', 'vié', 'von/G', 'é');
			epurateListAndApplyFlag(list, 'M', 'ion/G', 'ion/G', 'imo', 'isen/G', 'ision/G', 'ison/G', 'isié', 'ié');
			epurateListAndApplyFlag(list, 'N', 'mo', 'mo', 'sen/GH', 'sion/GH', 'son/GH', 'sié', 'vié', 'é');
			epurateListAndApplyFlag(list, 'P', 'ron/G', 'ron/G', 'remo', 'ren/G', 'resi', 'rion/M', 'ré', 'résimo', 'rí/I', 'rò', 'rà', 'rè', 'ré');
			epurateListAndApplyFlag(list, 'Q', 'ndo/B', 'ndo/B', 'n/GH', 'nte', 'rave');
			epurateListAndApplyFlag(list, 'R', 'mo', 'mo', 'de/K', 'ndo/Q', 'ron/P', 'se/E', 'si', 'sto/D', 'vo/D');
			epurateListAndApplyFlag(list, 'S', 'í/B', 'í/B', 'í', 'é/J', 'ú/I');/**/
		};

		/*var epurateListAndApplyFlag = function(list, flag, matcher, base){
			var matcherLength = matcher.length,
				replacement = Array.prototype.slice.call(arguments, 3, arguments.length),
				i, j, rep, repment, idx0, indices, parents,
				inters, p;
			matcher = new RegExp(matcher + '$');

			var lists;
			lists = replacement.map(function(last){
				matcher = new RegExp(last + '$');
				return list.filter(function(el){ return el.replacement.match(matcher); });
			});
			if(lists.some(function(list){ return !list.length; }))
				return;
console.log('hgf');
		};/**/

		var epurateListAndApplyFlag = function(list, flag, matcher){
			var matcherLength = matcher.replace(/\[.+\]/, '.').length,
				replacement = Array.prototype.slice.call(arguments, 3, arguments.length),
				i, j, rep, repment, indices, parents,
				inters, p;
			matcher = new RegExp(matcher + '$');

			for(i = list.length - 1; i >= 0; i --){
				repment = list[i].replacement;
				if(list.hasOwnProperty(i) && repment.match(matcher)){
					rep = list[i].replaced;
					repment = repment.substr(0, repment.length - matcherLength);

					indices = replacement.map(function(last){ return indexOfReplacement(list, rep, new RegExp(repment + last + '$')); });
					if(indices.some(function(el){ return (el < 0); }))
						continue;

					//here, all replacements are found

					//collect parents
					parents = indices.map(function(i){ return list[i].parents; });
					parents.push(list[i].parents);

					//test if all parents are the same
					if(!parents.every(function(p, i){ return p.equals(parents[(i + 1) % parents.length]); })){
						//extract common parts
						inters = intersection.apply(this, parents);

						indices.forEach(function(el){
							el = list[el];
							p = el.parents.difference(inters);

							//split-up
							if(p.length){
								list.push({
									replaced: el.replaced,
									replacement: el.replacement,
									form: el.form,
									parents: p
								});
								el.parents = inters.slice(0);
							}
						});
					}

					//here all the replacements shares the same parents

					//add flag
					list[i].replacement = list[i].replacement.replace(/(\/(.+))?$/, '/' + flag + '$2');

					//remove replaced items
					indices.forEach(function(el){
						list.splice(el, 1);

						if(el < i)
							i --;
					});
				}
			}
		};

		var indexOfReplacement = function(list, replaced, replacement){
			return list.findIndex(function(el){ return (el.replaced == replaced && el.replacement.match(replacement)); });
		};

		var extractIndexOfCommonPartFromStart = function(str1, str2){
			var i, len;
			for(i = 0, len = Math.min(str1.length, str2.length) - 1; i < len; i ++)
				if(str1[i] != str2[i])
					break;
			return i;
		};

		var extractCommonPartFromList = function(list){
			var form;
			list.forEach(function(obj, i){
				form = (!i? obj: extractCommonPartFromEnd(obj, form));
			});
			return form;
		};

		var extractCommonPartFromEnd = function(a, b){
			for(var i = 0, len = Math.min(a.length, b.length); i < len; i ++)
				if(a[a.length - i - 1] != b[b.length - i - 1])
					break;
			return (i > 0? a.substr(a.length - i): '');
		};

		var augmentForms = function(list){
			list.forEach(function(el){
				augmentSingleForm(el, 1, list);
			});
		};

		var augmentSingleForm = function(el, order, list){
			if(!el.extendedParents)
				el.extendedParents = collectParents(el, list);

			var current = extractVariability(el.form, order, el.parents),
				avoid = extractVariability(el.form, order, el.extendedParents),
				inters = intersection(avoid, current);
			if(inters.length)
				el.form = '*' + el.form;
			else if(el.extendedParents.indexOf(el.form) >= 0)
				el.form = (current.length > 0? current.getRegExp(): '') + el.form;
			else
				el.form = (avoid.length > 0? avoid.getNotRegExp(): '') + el.form;
		};

		var collectParents = function(el, list){
			var parents = [],
				matcher = new RegExp('^(\\*|\\[.+\\])?' + el.form.replace(/\*|\[.+\]|\/.+$/g, '') + '(\/.+)?$');
			list.forEach(function(obj){
				if(obj != el && obj.form.match(matcher))
					parents = parents.concat(obj.parents);
			});
			return parents.unique().difference(el.parents);
		};

		var extractVariability = function(form, order, list){
			var formLength = form.replace(/\*|\[.+\]|\/.+$/g, '').length,
				variability = [],
				idx;
			list.forEach(function(obj){
				idx = obj.length - formLength - order;
				variability.push(idx >= 0? obj.substr(idx, order): '_');
			});
			return variability.unique().sort();
		};

		var extractUnfeasible = function(list){
			return partition(list, function(value){ return (value.form.indexOf('*') >= 0); });
		};

		var searchForParentSubdivision = function(order, list){
			list.forEach(function(el){
				var parents = el.parents,
					variability = extractVariability(el.form, order, el.extendedParents.concat(el.parents)),
					len = variability.length,
					constraint = [],
					i, v, isStarred;
				for(i = 0; i < len; i ++){
					v = variability[i];
					if(!v)
						continue;

					el.form = el.form.replace(/\*|\[.+\]/g, '');

					subdivideParentsIf(constraint.concat(v).getRegExp(), el, list);

					augmentSingleForm(el, order);

					//undo what has be done in subdivideParentsIf
					isStarred = (el.form.indexOf('*') >= 0);
					if(i < len - 1 || isStarred){
						list.pop();
						el.parents = parents;
					}
					else
						augmentSingleForm(list[list.length - 1], order);

					if(!isStarred)
						constraint.push(v);
				}

				if(!isStarred && constraint.length && el.form.indexOf('[') < 0){
					constraint = constraint.getRegExp();

					el.replaced = constraint + el.replaced;
					el.replacement = constraint + el.replacement;
					el.form = constraint + el.form;
				}
			});
		};

		var subdivideParentsIf = function(constraint, el, list){
			var matcher = new RegExp(constraint + el.form + '$'),
				part = partition(el.extendedParents.concat(el.parents), function(value){ return value.match(matcher); });

			if(part[true] && part[false]){
				list.push({
					replaced: el.replaced,
					replacement: el.replacement,
					form: el.form,
					parents: part[false],
					extendedParents: el.extendedParents
				});
				el.parents = part[true];
			}
		};

		var transfer = function(destination, list){
			var move = list.filter(function(el){ return (el.form.indexOf('*') < 0); }),
				i, el;

			move.forEach(function(el){ destination.push(el); });

			for(i = list.length - 1; i >= 0; i --){
				el = list[i];
				if(el.form.indexOf('*') < 0)
					list.splice(i, 1);
				else
					el.form = el.form.replace(/\*|\[.+\]/g, '');
			}
		};

		var reduceParents = function(list){
			for(var i = list.length - 1; i >= 0; i --){
				reduceParent(list[i], list);

				if(!list[i].parents.length)
					list.splice(i, 1);
			}
		};

		var reduceParent = function(el, list){
			var i, j, p, idx, found,
				parent, parents, matcher;
			for(i = el.parents.length - 1; i >= 0; i --){
				p = el.parents[i];
				idx = p.search(/[àèéíòóú]/);

				j = 0;
				found = false;
				do{
					parent = p.substr(j ++);
					matcher = new RegExp(parent + '$');
					found = el.extendedParents.some(function(obj){ return obj.match(matcher); });
				}while(!found && (idx < 0 || j <= idx));

				if(parent.length > 1){
					if(found){
						parent = p.substr(j - 2);
						matcher = new RegExp(parent + '$');
					}
					parents = el.parents.filter(function(obj){ return obj.match(matcher); });

					list.push({
						replaced: el.replaced,
						replacement: el.replacement,
						form: parent,
						parents: parents,
						extendedParents: el.extendedParents
					});

					el.parents = el.parents.difference(parents);
					i = Math.min(i, el.parents.length - 1);
				}
			}
		};

		var reduceForms = function(list){
			list.forEach(function(el){
				if(el.form.indexOf('[') < 0)
					reduceForm(el, list);
			});
		};

		var reduceForm = function(el, list){
			var idx0 = el.form.search(/[àèéíòóú]/),
				idx1 = el.form.length - el.replaced.length;
			if(el.form.indexOf('[') < 0 && (idx0 < 0 || idx0 > 0)){
				var extracted = list.filter(function(obj){ return (obj.form == el.form); }),
					found = false,
					i, form, matcher;
				list = list.filter(function(obj){ return (obj.form != el.form); });

				for(i = 0; i <= idx1 && !found && (idx0 < 0 || i <= idx0); i ++){
					form = el.form.substr(i);
					matcher = new RegExp(form + '$');
					found = list.some(function(obj){ return obj.form.match(matcher); });
				}

				if(form && form.length > 2){
					if(found)
						form = el.form.substr(Math.max(0, i - 2));

					extracted.forEach(function(obj){
						obj.form = form;
					});
				}

				list = list.concat(extracted);
			}
		};

		var prettyPrint = function(list){
			var maxReplaced = list.reduce(function(previousValue, currentValue){ return Math.max(previousValue, currentValue.replaced.length); }, 0),
				maxReplacement = list.reduce(function(previousValue, currentValue){ return Math.max(previousValue, currentValue.replacement.length); }, 0),
				maxForm = list.reduce(function(previousValue, currentValue){ return Math.max(previousValue, currentValue.form.length); }, 0);
			list.map(function(el, idx){
				var text = 'SFX A ' + printPadded(el.replaced, maxReplaced) + ' ' + printPadded(el.replacement, maxReplacement)
					+ ' ' + printPadded(el.form, maxForm) + ' # ' + el.parents;
				list[idx] = text;
			});

			console.log('SFX A Y ' + list.length);
			list.sort().forEach(function(el){
				console.log(el);
			});
		};

		var printPadded = function(value, len){
			return value + Array(len - value.length + 1).join(' ');
		};


if(false)
		require(['tools/lang/morphology/Bla', 'tools/lang/morphology/Verb', 'tools/lang/data/VerbsDictionary', 'libs/jsonh'], function(Bla, Verb, verbsDictionary, JSONH){
			verbsDictionary = JSONH.unpack(verbsDictionary);

var start = +new Date();
			var verbs = [],
				paradigmEndings;
			verbsDictionary.forEach(function(infinitive){
				verbs.push(new Verb(composeInfinitive(infinitive)));
			});
			paradigmEndings = (new Bla()).generate(verbs);
console.log(((+new Date() - start) / 1000) + ' s');
		});/**/

if(true)
		require(['tools/lang/morphology/Bla2', 'tools/lang/morphology/Verb', 'tools/lang/data/VerbsDictionary', 'libs/jsonh'], function(Bla2, Verb, verbsDictionary, JSONH){
			verbsDictionary = JSONH.unpack(verbsDictionary);

var start = +new Date();
			var verbs = [];
			verbsDictionary.forEach(function(infinitive){
				verbs.push(new Verb(composeInfinitive(infinitive)));
			});
			Bla2.generate(verbs);
console.log(((+new Date() - start) / 60000) + ' min');
		});/**/

if(false)
		require(['tools/lang/phonology/Word', 'tools/lang/phonology/PhonologyHelper', 'tools/data/ArrayHelper', 'tools/lang/morphology/Conjugator', 'tools/lang/Dialect', 'tools/lang/morphology/Verb', 'tools/lang/morphology/Themizer', 'tools/lang/data/VerbsDictionary', 'libs/jsonh'], function(Word, PhonologyHelper, ArrayHelper, Conjugator, Dialect, Verb, Themizer, verbsDictionary, JSONH){
			verbsDictionary = JSONH.unpack(verbsDictionary);

			var list = [],
				paradigm = {},
				verb, forms, themes,
				idx, rep, repment, data,
				part, externalList;
var start = +new Date();
			verbsDictionary.forEach(function(infinitive){
				infinitive = composeInfinitive(infinitive);

				forms = Conjugator.extractForms(infinitive);
				forms = ArrayHelper.unique(forms
					.filter(function(x){
						return (x[x.length - 1] == '#' || forms.every(function(el){ return !el.match(new RegExp('^' + x + '#$')); }));
					})
					.map(function(form){
						return form.replace(/^#/, '').replace(/([or])#$/, '$1/BG').replace(/#$/, '/B').replace(/\$$/, '/G').replace(/@$/, '/H');
					})
				);
/*se pòl katar un metaplaxmo de deklinathion da la prima a la sekonda koniug. intel inparfèto (kantàa > kantéa, pensàse > pensése)
e intel partithipio pasivo (mañasto > mañésto).
sto metaplaxmo se pòl ‘verlo par tuti i mòdi e i tenpi (anka a partir da la 3a koniug.) fora ke inté ‘l infenío, partithipio, e xerundio
(mañerà, mañeríe).

Se pòl katar un metaplaxmo da la tertha a la sekonda koniug. intel partithipio pasivo ko la dexinentha in -st- (sentésto, dormésto)
e intel xerundio (finéndo).

T2 = T1: aŧento PVT > VT | à > é
T4 = T1: senŧa aŧento | à > e
*/

				/*forms.forEach(function(form){
					if(form.match(/ría$/))
						forms.push(form.replace(/ría$/, 'ríselo/D'));
				});*/

				infinitive = Word.unmarkDefaultStress(infinitive);

				forms.forEach(function(form){
					idx = extractIndexOfCommonPartFromStart(infinitive, form);

					rep = infinitive.substr(idx);
					repment = form.substr(idx);

					idx = list.findIndex(function(el){ return (el.replaced == rep && el.replacement == repment); });
					if(idx < 0)
						list.push({replaced: rep, replacement: repment, parents: [infinitive], form: infinitive});
					else{
						data = list[idx];
						if(data.parents.indexOf(infinitive) < 0){
							data.parents.push(infinitive);
							data.form = extractCommonPartFromEnd(infinitive, data.form);
						}
					}
				});
			});
console.log(((+new Date() - start) / 60000) + ' min');

			applyReductions(list);

			/*augmentForms(list);

			part = extractUnfeasible(list);
			list = part[false];
			externalList = part[true];

			searchForParentSubdivision(1, externalList);
			transfer(list, externalList);

			reduceForms(list);

			reduceParents(externalList);
			transfer(list, externalList);/**/

			prettyPrint(list);/**/
		});/**/

/*		require(['tools/lang/phonology/Word', 'tools/lang/phonology/PhonologyHelper', 'tools/lang/morphology/Conjugator', 'tools/lang/Dialect', 'tools/lang/morphology/Verb', 'tools/lang/morphology/Themizer', 'tools/lang/data/VerbsDictionary', 'libs/jsonh'], function(Word, PhonologyHelper, Conjugator, Dialect, Verb, Themizer, verbsDictionary, JSONH){
			verbsDictionary = JSONH.unpack(verbsDictionary);

			var list = [],
				verb, forms, themes,
				idx, repment, data,
				part, externalList;
			verbsDictionary.forEach(function(infinitive){
				infinitive = composeInfinitive(infinitive);

//				verb = new Verb(infinitive);
//				themes = (new Themizer(verb, new Dialect())).generate();

				forms = Conjugator.extractForms(infinitive, null, true);
				forms = forms.map(function(form){
					return form.replace(/^#/, '').replace(/([or])#$/, '$1/BG').replace(/#$/, '/B').replace(/\$$/, '/G');
				});
				forms = forms.filter(function(x, i){
					return (forms.indexOf(x) == i && forms.every(function(el){ return !el.match(x + '\/.+$'); }));
				});
/*se pòl katar un metaplaxmo de deklinathion da la prima a la sekonda koniug. intel inparfèto (kantàa > kantéa, pensàse > pensése)
e intel partithipio pasivo (mañasto > mañésto).
sto metaplaxmo se pòl ‘verlo par tuti i mòdi e i tenpi (anka a partir da la 3a koniug.) fora ke inté ‘l infenío, partithipio, e xerundio
(mañerà, mañeríe).

Se pòl katar un metaplaxmo da la tertha a la sekonda koniug. intel partithipio pasivo ko la dexinentha in -st- (sentésto, dormésto)
e intel xerundio (finéndo).

T2 = T1: aŧento PVT > VT | à > é
T4 = T1: senŧa aŧento | à > e
*/
				/*forms.forEach(function(form){
					var m = form.match(/\/.+$/),
						f = form.replace(/\/.+$/, ''),
						form2 = PhonologyHelper.vowelLoweringCombinatorialVariation(f, 'central');
					if(form2 != f)
						forms.push(form2 + (m? m[0]: ''));
				});*/

/*				forms.forEach(function(form){
					if(form.match(/ría$/))
						forms.push(form.replace(/ría$/, 'ríselo/D'));
				});*/

/*				infinitive = Word.unmarkDefaultStress(infinitive);

				forms.forEach(function(form){
					idx = extractIndexOfCommonPart(form, infinitive);

					repment = form.substr(idx);

					data = {
						replaced: infinitive.substr(idx),
						replacement: repment,
						form: infinitive,
						parents: [infinitive]
					};

					idx = list.findIndex(function(el){ return (el.replaced == data.replaced && el.replacement == data.replacement); });
					if(idx < 0)
						list.push(data);
					else if(list[idx].parents.indexOf(data.parents[0]) < 0){
						list[idx].parents.push(data.parents[0]);
						list[idx].form = extractCommonPartFromList(list[idx].parents);
					}
				});
			});

			applyReductions(list);

			augmentForms(list);

			part = extractUnfeasible(list);
			list = part[false];
			externalList = part[true];

			searchForParentSubdivision(1, externalList);
			transfer(list, externalList);

			reduceForms(list);

			reduceParents(externalList);
			transfer(list, externalList);

			prettyPrint(list);
		});/**/

		/*require(['tools/lang/phonology/Word', 'tools/lang/morphology/Conjugator', 'tools/lang/data/VerbsDictionary', 'libs/jsonh'], function(Word, Conjugator, verbsDictionary, JSONH){
			verbsDictionary = JSONH.unpack(verbsDictionary);

			var k, infinitive;
			for(k in verbsDictionary){
				infinitive = composeInfinitive(verbsDictionary[k]);
				infinitive = Word.unmarkDefaultStress(infinitive);

				console.log(infinitive + '/A');
			}
			console.log('done ' + verbsDictionary.length);
		});/**/

		/*require(['tools/lang/phonology/Orthography', 'tools/lang/data/VerbsDictionary', 'libs/jsonh'], function(Orthography, verbsDictionary, JSONH){
			verbsDictionary = JSONH.unpack(verbsDictionary);

			var k, infinitive;
			for(k in verbsDictionary){
				infinitive = composeInfinitive(verbsDictionary[k]);

				if(infinitive !== Orthography.correctOrthography(infinitive))
					console.log('error on form ' + infinitive);
			}
			console.log('done ' + verbsDictionary.length);
		});/**/
	</script>
</head>

<body>
</body>
</html>

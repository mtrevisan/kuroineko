<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="author" content="Mauro Trevisan">
	<link rel="shortcut icon" href="../favicon.png" />

	<title>test HunspellDuplicates</title>

	<script src="../app/AMDLoader.js"></script>

	<script>
		AMDLoader.config = {
			baseUrl: '../app',
			paths: {
				libs: '../libs'
			}
		};


		require(['tools/spellchecker/HunspellGenerator', 'text!tools/lang/data/dict-vec-oxt/dictionaries/vec.aff', 'text!tools/lang/data/dict-vec-oxt/dictionaries/vec.dic', 'tools/data/structs/Trie'], function(HunspellGenerator, affFile, dicFile, Trie){
			var generator = new HunspellGenerator(affFile);
			var dictionary = dicFile.split(/[\r\n]+/);
			//remove the counter
			dictionary.shift();

//			var t = new Trie();
			var duplicates = new Map();
			/*var dict = new Set();
			var productions = [];*/
			dictionary.forEach(function(word){
				if(!/^\s*\//.test(word) && word.length){
					word = word.replace(/\t.*$/, '');

					var continuationClasses = generator.extractContinuationClasses(word);
					continuationClasses.forEach(function(continuationClass){
						if(!generator.hasRule(continuationClass))
							console.log('rule for class ' + continuationClass + ' not found');
					});

/*					var suggestions = generator.applyRules(word);
					suggestions.forEach(function(el){
						var suggestion = el.suggestion;
						if(t.contains(suggestion)){
							var count = duplicates.get(suggestion) | 0;
							duplicates.set(suggestion, count + 1);
						}
						else
							t.add(suggestion);
					});
/*					word = word.replace(/\t.*$/, '');

					var suggestions = generator.applyRules(word);
					/*suggestions.forEach(function(el){
						var suggestion = el.suggestion;
						if(dict.has(suggestion)){
							var count = duplicates.get(suggestion) | 0;
							duplicates.set(suggestion, count + 1);
						}
						else
							dict.add(suggestion);
					});*/
/*					suggestions.forEach(function(el){
						productions.push(el.suggestion);
					});*/
				}
			});

			/*productions.forEach(function(suggestion, idx){
				//find if there is a duplicate or not
				if(productions.indexOf(suggestion, idx + 1) > -1)
					//find if the element is already in the duplicates or not
					duplicates.put(suggestion, (duplicates.get(suggestion) | 0) + 1);
			});*/
//console.log(productions);
console.log(duplicates);
console.log('end');
		});

	</script>
</head>

<body>
</body>
</html>

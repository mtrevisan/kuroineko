<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="author" content="Mauro Trevisan">
	<link rel="shortcut icon" href="../favicon.png" />

	<title>test fraction</title>

	<link rel="stylesheet" href="../test/lib/qunit/qunit-1.18.0.css">

	<script src="../test/lib/qunit/qunit-1.18.0.js"></script>

	<script src="../app/AMDLoader.js"></script>

	<script>
		AMDLoader.config = {
			baseUrl: '../app',
			paths: {
				libs: '../libs'
			}
		};


		require(['tools/math/Fraction'], function(Fraction){
			asyncTest('constructor with object', function(){
				var f = new Fraction({
					num: -13,
					den: 27
				});

				equal(f.num, 13);
				equal(f.den, 27);
				equal(f.sgn, -1);

				start();
			});

			asyncTest('constructor with array', function(){
				var f = new Fraction(-13, 27);

				equal(f.num, 13);
				equal(f.den, 27);
				equal(f.sgn, -1);

				start();
			});

			asyncTest('constructor with number', function(){
				var f = new Fraction(-13.27);

				equal(f.num, 1327);
				equal(f.den, 100);
				equal(f.sgn, -1);

				start();
			});

			asyncTest('constructor with big number', function(){
				var f = Fraction.fromNumber(1234567.9991829, 1e-10);

				equal(f.num, 385102500000);
				equal(f.den, 311933);

				start();
			});

			asyncTest('constructor with long number', function(){
				var f = Fraction.fromNumber(0.9999999999);

				equal(f.num, 9999999999);
				equal(f.den, 10000000000);

				start();
			});

			asyncTest('constructor with big number as string', function(){
				var f = new Fraction('1234567.9991829');

				equal(f.num, 12345679991829);
				equal(f.den, 10000000);

				start();
			});

			asyncTest('constructor with number', function(){
				var f = Fraction.fromNumber(355 / 113);

				equal(f.num, 355);
				equal(f.den, 113);
				equal(f.sgn, 1);

				start();
			});

			asyncTest('constructor with string (negative)', function(){
				var f = new Fraction('-13.27');

				equal(f.num, 1327);
				equal(f.den, 100);
				equal(f.sgn, -1);

				start();
			});

			asyncTest('constructor with string (positive)', function(){
				var f = new Fraction('5.12');

				equal(f.num, 128);
				equal(f.den, 25);
				equal(f.sgn, 1);

				start();
			});

			asyncTest('constructor with string (repeating decimals)', function(){
				var f = new Fraction('5.13(31)');

				equal(f.num, 25409);
				equal(f.den, 4950);
				equal(f.sgn, 1);

				start();
			});

			asyncTest('constructor with string fraction', function(){
				var f = new Fraction('5/13');

				equal(f.num, 5);
				equal(f.den, 13);
				equal(f.sgn, 1);

				start();
			});

			asyncTest('constructor with positive infinite', function(){
				var f = new Fraction(10, 0);

				equal(f.num, 1);
				equal(f.den, 0);
				equal(f.sgn, 1);

				start();
			});

			asyncTest('constructor with negative infinite', function(){
				var f = new Fraction(-10, 0);

				equal(f.num, 1);
				equal(f.den, 0);
				equal(f.sgn, -1);

				start();
			});

			asyncTest('GCD', function(){
				var f1 = new Fraction('5/8');
				var f2 = new Fraction('3/7');

				equal(f1.gcd(f2).toString(), new Fraction('1/56').toString());

				start();
			});

			asyncTest('add', function(){
				var f1 = new Fraction('5.13(31)');
				var f2 = new Fraction('2.3(7)');

				equal(f1.add(f2).toNumber(), new Fraction('7.51(09)').toNumber());

				start();
			});

			asyncTest('mul', function(){
				var f1 = new Fraction('5.13(31)');
				var f2 = new Fraction('2.3(7)');

				equal(f1.mul(f2).toNumber(), new Fraction(2718763, 222750).toNumber());

				start();
			});

			asyncTest('abs with positive number', function(){
				var f = new Fraction(1, 7);

				equal(f.abs().toNumber(), new Fraction(1, 7).toNumber());

				start();
			});

			asyncTest('abs with negative number', function(){
				var f = new Fraction(-1, 7);

				equal(f.abs().toNumber(), new Fraction(1, 7).toNumber());

				start();
			});

			asyncTest('pow with positive number', function(){
				var f = new Fraction(2, 3);

				equal(f.pow(2).toNumber(), new Fraction(4, 9).toNumber());

				start();
			});

			asyncTest('pow with negative number', function(){
				var f = new Fraction(-2, 3);

				equal(f.pow(-2).toNumber(), new Fraction(9, 4).toNumber());

				start();
			});

			asyncTest('isDivisible true', function(){
				var f1 = new Fraction(19, 6);
				var f2 = new Fraction(38, 12);

				equal(f1.isDivisibleBy(f2), true);

				start();
			});

			asyncTest('isDivisible false', function(){
				var f1 = new Fraction(19, 6);
				var f2 = new Fraction(5, 98);

				equal(f1.isDivisibleBy(f2), false);

				start();
			});

			asyncTest('to positive string 1', function(){
				var f = new Fraction('5.13(31)');

				equal(f.toString(), '5.13(31)');

				start();
			});

			asyncTest('to positive string 2', function(){
				var f = new Fraction('0.13(31)');

				equal(f.toString(), '0.13(31)');

				start();
			});

			asyncTest('to positive string with zeros 1', function(){
				var f = new Fraction('5000.13(31)');

				equal(f.toString(), '5000.13(31)');

				start();
			});

			asyncTest('to positive string with zeros 2', function(){
				var f = new Fraction('5.00013(31)');

				equal(f.toString(), '5.00013(31)');

				start();
			});

			asyncTest('to negative string', function(){
				var f = new Fraction('-5.13(31)');

				equal(f.toString(), '-5.13(31)');

				start();
			});

			asyncTest('to LaTeX zero', function(){
				var f = new Fraction('0');

				equal(f.toLaTeX(), '0');

				start();
			});

			asyncTest('to LaTeX integer', function(){
				var f = new Fraction('-10');

				equal(f.toLaTeX(), '-10');

				start();
			});

			asyncTest('to LaTeX positive fraction', function(){
				var f = new Fraction('1.5');

				equal(f.toLaTeX(), '\\frac{3}{2}');

				start();
			});

			asyncTest('to LaTeX negative fraction', function(){
				var f = new Fraction('-1.5');

				equal(f.toLaTeX(), '-\\frac{3}{2}');

				start();
			});
		});
	</script>
</head>

<body>
	<div id="qunit"></div>
	<div id="qunit-fixture"></div>
</body>
</html>

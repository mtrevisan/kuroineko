<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="author" content="Mauro Trevisan">
	<link rel="shortcut icon" href="../favicon.png" />

	<title>test hypenator</title>

	<script src="../app/AMDLoader.js"></script>

	<script>
		AMDLoader.config = {
			baseUrl: '../app',
			paths: {
				libs: '../libs'
			}
		};

		/**
		 * @class Hypenator
		 *
		 * @see {@link https://github.com/mnater/Hyphenator/blob/master/Hyphenator.js}
		 *
		 * @author Mauro Trevisan

		Hyphenator.languages['it'] = {
			leftmin: 1,
			rightmin: 2,
			patterns: {
				2: '1b1c1d1f1g1h1j1k1l1m1n1p1q1r1t1v1w1x1z',
				3: '2’2e2w2bb2bc2bd2bf2bm2bn2bp2bs2bt2bvb2lb2r2b_2b’2cb2cc2cd2cf2ck2cm2cn2cq2cs2ct2czc2hc2lc2r2c_2c’_c22db2dd2dg2dl2dm2dn2dpd2r2ds2dt2dv2dw2d_2d’_d22fb2fg2ff2fnf2lf2r2fs2ft2f_2f’2gb2gd2gf2ggg2hg2l2gmg2n2gpg2r2gs2gt2gv2gw2gz2g_2g’2hb2hd2hhh2l2hm2hn2hr2hv2h_2h’2j_2j’2kg2kfk2h2kkk2l2kmk2r2ks2kt2k_2k’2lb2lc2ld2lgl2h2lk2ll2lm2ln2lp2lq2lr2ls2lt2lv2lw2lz2l_2mb2mc2mf2ml2mm2mn2mp2mq2mr2ms2mt2mv2mw2m_2m’2nb2nc2nd2nf2ng2nk2nl2nm2nn2np2nq2nr2ns2nt2nv2nz2n_2n’2pdp2hp2l2pn2ppp2r2ps2pt2pz2p_2p’2qq2q_2q’2rb2rc2rd2rfr2h2rg2rk2rl2rm2rn2rp2rq2rr2rs2rt2rv2rx2rw2rz2r_2r’1s22sz4s_2tb2tc2td2tf2tgt2ht2l2tm2tn2tpt2rt2s2tt2tv2twt2z2t_2vcv2lv2r2vv2v_w2h2w_2w’2xb2xc2xf2xh2xm2xp2xt2xw2x_2x’y1i2zb2zd2zl2zn2zp2zt2zs2zv2zz2z_',
				4: '_p2sa1iaa1iea1ioa1iua1uoa1ya2at_e1iuo1iao1ieo1ioo1iu2chh2chbch2r2chn2l’_2l’’2shm2sh_2sh’2s3s2stb2stc2std2stf2stg2stm2stn2stp2sts2stt2stv4s’_4s’’2tzktz2s2t’_2t’’2v’_2v’’wa2r2w1yy1ou2z’_2z’’_z2',
				5: '_bio1_pre12gh2t2l3f2n2g3n3p2nes4s3mt2t3s',
				6: '_a3p2n_anti1_free3_opto1_para1hi3p2n2nheit3p2sicr2t2s32s3p2n3t2sch',
				7: '_ca4p3s_e2x1eu_narco1_su2b3r_wa2g3n_wel2t1n2s3fer',
				8: '_contro1_fran2k3_li3p2sa_orto3p2_poli3p2_sha2re3_su2b3lu',
				9: '_anti3m2n_circu2m1_re1i2scr_tran2s3c_tran2s3d_tran2s3l_tran2s3n_tran2s3p_tran2s3r_tran2s3t',
				10: '_di2s3cine'
			}
		};

		 */
		require(['tools/data/structs/Trie', 'tools/lang/phonology/Syllabator', 'tools/lang/phonology/Word'], function(Trie, Syllabator, Word){

			var cache = {},
				trie, trieData,
//				softHyphen = String.fromCharCode(173);
//				softHyphen = \u00AD;
				softHyphen = '-';

			var enableCache = true;
			var exceptions = {};
			//minimal length of characters before the first hyphenation
			var leftmin = 1;
			//minimal length of characters after the last hyphenation
			var rightmin = 0;


			var readPatterns = function(patterns){
				trie = new Trie();
				trieData = new Map();

				var cleanPattern, node;
				Object.keys(patterns).forEach(function(length){
					chunkString(patterns[length], length).forEach(function(pattern){
						cleanPattern = pattern.replace(/\d/g, '');
						node = trie.add(cleanPattern);
						trieData.set(node, pattern);
					});
				}, patterns);
			};

			/** @private */
			var chunkString = function(str, length){
				return str.match(new RegExp('.{' + length + '}', 'g'));
			};

			var hypenate = function(word){
				word = Word.markDefaultStress(word);

				var hypenatedWord = '';
				if(word.indexOf(softHyphen) >= 0)
					//word already contains &shy; then leave as it is
					hypenatedWord = word;
				else if(enableCache && cache[word])
					//the word is in the cache
					hypenatedWord = cache[word];
				else if(exceptions && exceptions[word])
					//the word is in the exceptions list
					hypenatedWord = exceptions[word].replace(/-/g, softHyphen);
				else if(word.indexOf('-') >= 0)
					//if word contains '-' then hyphenate the parts separated with '-'
					hypenatedWord = word.split('-')
						.map(hypenate)
						.join('-');
				else{
					var ww = '.' + word.toLowerCase() + '.';
					if(String.prototype.normalize)
						ww = ww.normalize();
					if(ww.match(/[^-'‘’aàbcdđeéèfghiíjɉklƚmnñoóòprsʃtŧuúvxʒ.]/))
						return word;

					var size = ww.length,
						hyp = [],
						i, j,
						tmp;
					for(i = 0; i < size; i ++){
						tmp = ww.substring(i);
						trie.findPrefix(tmp).forEach(function(pref){
							console.log('prefix ' + pref.node.prefix + ', node ' + trieData.get(pref.node));

							j = -1;
							trieData.get(pref.node).split('').forEach(function(d){
								d = parseInt(d);
								if(isNaN(d))
									j ++;
								else if(!hyp[i + j] || d > hyp[i + j])
									hyp[i + j] = d;
							});
						});
					}

					//create hyphenated word
					var maxLength = word.length - rightmin;
					hypenatedWord = word.split('').map(function(chr, idx){
						return (idx >= leftmin && idx <= maxLength && this[idx] % 2? softHyphen: '') + chr;
					}, hyp).join('');

					if(enableCache)
						//put the word in the cache
						cache[word] = hypenatedWord;
				}

				return hypenatedWord;
			};

			/** @private */
			var syllabatePhonematicAndJoin = function(word){
				return Syllabator.syllabate(word, undefined, false).syllabes.join(softHyphen);
			};


			readPatterns({
				/*2: '1b1c1d1f1g1h1j1k1l1m1n1p1q1r1t1v1w1x1z',
				3: '2’2e2w2bb2bc2bd2bf2bm2bn2bp2bs2bt2bvb2lb2r2b.2b’2cb2cc2cd2cf2ck2cm2cn2cq2cs2ct2czc2hc2lc2r2c.2c’.c22db2dd2dg2dl2dm2dn2dpd2r2ds2dt2dv2dw2d.2d’.d22fb2fg2ff2fnf2lf2r2fs2ft2f.2f’2gb2gd2gf2ggg2hg2l2gmg2n2gpg2r2gs2gt2gv2gw2gz2g.2g’2hb2hd2hhh2l2hm2hn2hr2hv2h.2h’2j.2j’2kg2kfk2h2kkk2l2kmk2r2ks2kt2k.2k’2lb2lc2ld2lgl2h2lk2ll2lm2ln2lp2lq2lr2ls2lt2lv2lw2lz2l.2mb2mc2mf2ml2mm2mn2mp2mq2mr2ms2mt2mv2mw2m.2m’2nb2nc2nd2nf2ng2nk2nl2nm2nn2np2nq2nr2ns2nt2nv2nz2n.2n’2pdp2hp2l2pn2ppp2r2ps2pt2pz2p.2p’2qq2q.2q’2rb2rc2rd2rfr2h2rg2rk2rl2rm2rn2rp2rq2rr2rs2rt2rv2rx2rw2rz2r.2r’1s22sz4s.2tb2tc2td2tf2tgt2ht2l2tm2tn2tpt2rt2s2tt2tv2twt2z2t.2vcv2lv2r2vv2v.w2h2w.2w’2xb2xc2xf2xh2xm2xp2xt2xw2x.2x’y1i2zb2zd2zl2zn2zp2zt2zs2zv2zz2z.',
				4: '.p2sa1iaa1iea1ioa1iua1uoa1ya2at.e1iuo1iao1ieo1ioo1iu2chh2chbch2r2chn2l’.2l’’2shm2sh.2sh’2s3s2stb2stc2std2stf2stg2stm2stn2stp2sts2stt2stv4s’.4s’’2tzktz2s2t’.2t’’2v’.2v’’wa2r2w1yy1ou2z’.2z’’.z2',
				5: '.bio1.pre12gh2t2l3f2n2g3n3p2nes4s3mt2t3s',
				6: '.a3p2n.anti1.free3.opto1.para1hi3p2n2nheit3p2sicr2t2s32s3p2n3t2sch',
				7: '.ca4p3s.e2x1eu.narko1.su2b3r.wa2g3n.wel2t1n2s3fer',
				8: '.contro1.fran2k3.li3p2sa.orto3p2.poli3p2.sha2re3.su2b3lu',
				9: '.anti3m2n.circu2m1.re1i2scr.tran2s3c.tran2s3d.tran2s3l.tran2s3n.tran2s3p.tran2s3r.tran2s3t',
				10: '.di2s3cine'/**/

				2: '1b1c1d1đ1f1g1j1ɉ1k1l1ƚ1m1n1ñ1p1r1s1t1ŧ1v1x',
				3: '.c2.d2.đ2.k2.s2.ŧ2.x2'
					+ '2b.2bc2bd2bđ2bf2bg2bj2cɉ2bk2bl2bm2bn2bñ2bp2br2bs2bt2bŧ2bv2bx'
					+ '2c.2cb2cd2cđ2cf2cg2cj2cɉ2ck2cl2cm2cn2cñ2cp2cr2cs2ct2cŧ2cv2cx'
					+ '2d.2db2dc2dđ2df2dg2dj2dɉ2dk2dl2dm2dn2dñ2dp2dr2ds2dt2dŧ2dv2dx'
					+ '2đ.2đb2đc2đd2đf2đg2đj2đɉ2đk2đl2đm2đn2đñ2đp2đr2đs2đt2đŧ2đv2đx'
					+ '2f.2fb2fc2fd2fđ2fg2fj2fɉ2fk2fl2fm2fn2fñ2fp2fr2fs2ft2fŧ2fv2fx'
					+ '2g.2gb2gc2gd2gđ2gf2gj2gɉ2gk2gl2gm2gn2gñ2gp2gr2gs2gt2gŧ2gv2gx'
					+ '2j.2jb2jc2jd2jđ2jf2jg2jɉ2jk2jl2jm2jn2jñ2jp2jr2js2jt2jŧ2jv2jx'
					+ '2ɉ.2ɉb2ɉc2ɉd2ɉđ2ɉf2ɉg2ɉj2ɉk2ɉl2ɉm2ɉn2ɉñ2ɉp2ɉr2ɉs2ɉt2ɉŧ2ɉv2ɉx'
					+ '2k.2kb2kc2kd2kđ2kf2kg2kj2kɉ2kl2km2kn2kñ2kp2kr2ks2kt2kŧ2kv2kx'
					+ '2l.2lb2lc2ld2lđ2lf2lg2lj2lɉ2lk2lm2ln2lñ2lp2lr2ls2lt2lŧ2lv2lx'
					+ '2m.2mb2mc2md2mđ2mf2mg2mj2mɉ2mk2ml2mn2mñ2mp2mr2ms2mt2mŧ2mv2mx'
					+ '2n.2nb2nc2nd2nđ2nf2ng2nj2nɉ2nk2nl2nm2nñ2np2nr2ns2nt2nŧ2nv2nx'
					+ '2ñ.2ñb2ñc2ñd2ñđ2ñf2ñg2ñj2ñɉ2ñk2ñl2ñm2ñn2ñp2ñr2ñs2ñt2ñŧ2ñv2ñx'
					+ '2p.2pb2pc2pd2pđ2pf2pg2pj2pɉ2pk2pl2pm2pn2pñ2pr2ps2pt2pŧ2pv2px'
					+ '2r.2rb2rc2rd2rđ2rf2rg2rj2rɉ2rk2rl2rm2rn2rñ2rp2rs2rt2rŧ2rv2rx'
//					+ '4s.2sc2sf2sk2sp2st2sŧ2sx'
					+ '4s.s2t'
					+ '2t.2tb2tc2td2tđ2tf2tg2tj2tɉ2tk2tl2tm2tn2tñ2tp2tr2ts2tŧ2tv2tx'
					+ '2ŧ.2ŧb2ŧc2ŧd2ŧđ2ŧf2ŧg2ŧj2ŧɉ2ŧk2ŧl2ŧm2ŧn2ŧñ2ŧp2ŧr2ŧs2ŧt2ŧv2ŧx'
					+ '2v.2vb2vc2vd2vđ2vf2vg2vj2vɉ2vk2vl2vm2vn2vñ2vp2vr2vs2vt2vŧ2vx'
//					+ '4x.2xb2xd2xđ2xg2xj2xɉ2xl2xm2xn2xñ2xr2xs2xv'
					+ 'b2lb2r'
					+ 'c2lc2r'
					+ 'd2ld2r'
					+ 'f2lf2r'
					+ 'g2lg2r'
					+ 'j2lj2r'
					+ 'ɉ2lɉ2r'
					+ 'k2lk2r'
					+ 'm2n'
					+ 'p2lp2r'
					+ 't2lt2r'
					+ 'v2lv2r'
					+ 'í1aí1eí1ií1oí1uú1aú1eú1iú1oú1u'
				//i1
				//[aeiou]i2[aeiouàèéíòóú]
				//[àèéíòóú]i2[aeiou]
				//i2[^aeiouàèéíòóú] = i2[bcdđfgjɉklƚmnñprstŧvx]
					+ 'i1ai1ei1oi1ài1èi1éi1òi1óu1au1eu1ou1àu1èu1éu1òu1ó'
					+ 'a1aa1ea1oa1àa1èa1éa1ía1òa1óa1úe1ae1ee1oe1àe1èe1ée1íe1òe1óe1úo1ao1eo1oo1ào1èo1éo1ío1òo1óo1ú'
					+ 'à1aè1aé1aò1aó1aà1eè1eé1eò1eó1eà1oè1oé1oò1oó1o',
				4: '.f2t.p2n.p2s.t2m',
				5: '.bio1.pre12l3f2',
				6: 'sub3s2.para1.opto1.anti1',
				7: '.su2b3lkontro1ekstra1',
				8: '.re1iskr.poli3p2s',
				9: '.ŧirku2m1.orto3p2n',
				10: '.ŧirkum3n2.ŧirkum3s2'/**/

				//aàbcdđeéèfghiíjɉklƚmnñoóòprstŧuúvx
				//greek digrams
				/*+ 'b1db1mb1nb1sb1t'
				+ 'k1mk1nk1s'
				+ 't1nt1s'
				+ 'm1lm1r'
				+ 'n1ln1r'
				+ 'r1l',
//			.replace(/([jw])([lr])/g, replacement)
			/[sx]1(?=[^jwaeiouàèéíòóú])/
			/[aeiouàèéíòóú][sx]1(?=[^jwaeiouàèéíòóú])/ */
			});
			var words = [
				//bc
				'subcelular',
				//bd
				'abdegar',
				//bđ
				//bf
				'subfornidura',
				//bg
				//bj
				//bɉ
				//bk
				'subkortegal',
				//bl
				'ablativo', 'blandir',
				//bm
				'submontan',
				//bn
				'subnormal',
				//bñ
				//bp
				'subpolar',
				//br
				'abraŧar', 'braŧo',
				//bs([fo]|[kt]r)
				'obsoleto', 'subsfèrego', 'subskríver', 'substrato',
				//bt[or]
				'subtotal', 'subtropegal',
				//bŧ
				//bv
				'subvéder',
				//bx

				//db
				//dc
				//dđ
				//df
				//dg
				//dj
				//dɉ
				//dk
				//dl
				//dm
				'kadmio',
				//dn
				'ekidna',
				//dñ
				//dp
				//dr
				'dreŧar', 'adria',
				//ds
				'feldspato',
				//dt
				//dŧ
				//dv
				'advokaŧion',
				//dx

				//fb
				//fc
				//fd
				//fđ
				//fg
				'afgan',
				//fj
				//fɉ
				//fk
				//fl
				'fluido', 'reflèso',
				//fm
				//fn
				'afnio',
				//fñ
				//fp
				//fr
				'fruto', 'xafran',
				//fs
				//ft
				'afta', 'ftàlego',
				//fŧ
				//fv
				//fx

				//gb
				//gc
				//gd
				'amígdala',
				//gđ
				//gf
				'stagflaŧion',
				//gj
				//gɉ
				//gk
				//gl
				'glòria', 'kúgluf',
				//gm
				'dògma',
				//gn
				//gñ
				//gp
				//gr
				'grado', 'negro',
				//ngs(tr?)?
				'tungsteno', 'angstrom',
				//gt
				//gŧ
				//gv
				//gx

				//kb
				'ekbòlego',
				//kc
				//kd
				'ekdèmego',
				//kđ
				//kf
				//kg
				//kj
				//kɉ
				//kl
				'biŧikleta', 'klàsego',
				//km
				'drakma',
				//kn
				'akne',
				//kñ
				//kp
				//kr
				'krea', 'sakro',
				//ks
				'fuksia',
				//kt
				'ektòpego',
				//kŧ
				//kv
				//kx

				//lb
				'àlbaro',
				//lc
				'alcon',
				//ld
				'aldir',
				//lđ
				'vòlđer',
				//lf
				'talfiada', 'fenolftaleina',
				//lg
				'alguaro',
				//lj
				'induljentar',
				//lɉ
				'nervalɉía',
				//lk
				'palko',
				//lm
				'kalmo',
				//ln
				'malnutrío',
				//lñ
				//lp
				'alpi',
				//lr
				'malriesío',
				//ls
				'malsan',
				//lt
				'alto',
				//lŧ
				'xmalŧar',
				//lv
				'malva',
				//lx
				'bolxèr',

				//mb
				//mc
				//md
				//mđ
				//mf
				//mg
				//mj
				//mɉ
				//mk
				//ml
				'umlaut',
				//mn
				'amnexía', 'mnèxi', 'ŧirkumnavegar', 'ŧirkumnavegador', 'ŧirkumnavigaŧion',
				//mñ
				//mp
				'ŧirkumpadano', 'ŧirkumpolar',
				//mr
				//ms
				'ŧirkumstelar',
				//mt
				'fèmto',
				//mŧ
				//mv
				'ŧirkumvexuvian',
				//mx

				//nb
				'kanbio',
				//nc
				'mincon',
				//nd
				'mondo',
				//nđ
				'mónđar',
				//nf
				'onfegar',
				//ng
				'óngaro',
				//nj
				//nɉ
				'konɉedar',
				//nk
				'bianko',
				//nl
				'inluamar',
				//nm
				'inmanegar',
				//nñ
				//np
				'inpakar', 'inprontar', 'lanpar',
				//nr
				'manrovèrso',
				//ns
				'riensir', 'stransir',
				//nt
				'santan',
				//nŧ
				'sapienŧa',
				//nv
				'skonveñir',
				//nx
				'skonxurar',

				//pb
				//pc
				//pd
				//pđ
				//pf
				//pg
				//pj
				//pɉ
				//pk
				//pl
				'plaka', 'reoplano',
				//pm
				//pn
				'apnèa', 'pnèumo', 'polipnèa', 'ortopnèa', 'ortopnòika',
				//pñ
				//pr
				'prova', 'inprontar',
				//ps
				'psiko', 'asèpsi', 'polipsònio', 'kàpsula',
				//pt
				'adèpto',
				//pŧ
				//pv
				//px

				//rb
				'èrba',
				//rc
				'percepisio',
				//rd
				'pèrdar',
				//rđ
				'skovèrđer',
				//rf
				'serfojaro',
				//rg
				'serurgo',
				//rj
				'xmarjasada',
				//rɉ
				'sperɉurar',
				//rk
				'sporkar',
				//rl
				'stangerlon',
				//rm
				'sterminar',
				//rn
				'stornar',
				//rñ
				'gorñal',
				//rp
				'skarpa',
				//rs
				'bituarse',
				//rt
				'abortir',
				//rŧ
				'arŧon',
				//rv
				'servir',
				//rx
				'garxar',

				//sc
				'scòna',
				//sf
				'sfogo',
				//sk
				'skala', 'tanaska', 'reiskríver',
				//sp
				'spèco', 'vèspa',
				//st
				'vestir', 'astro', 'stómego', 'strafanto',
				//sŧ
				//sx

				//tb
				//tc
				//td
				//tđ
				//tf
				//tg
				//tj
				//tɉ
				//tk
				'sotkòŧ',
				//tl
				//tm
				'tmèxi', 'algoritmo',
				//tn
				'ètniko',
				//tñ
				//tp
				//tr
				'trapano', 'arto', 'artrite',
				//ts
				//tŧ
				//tv
				//tx

				//vb
				//vc
				//vd
				//vđ
				//vf
				//vg
				//vj
				//vɉ
				//vk
				//vl
				//vm
				//vn
				//vñ
				//vp
				//vr
				'manòvra',
				//vs
				//vt
				//vŧ
				//vx

				//xb
				'xbaketar', 'cixbar',
				//xc
				//xd
				'kaxdrafo',
				//xđ
				//xf
				//xg
				'xgajo',
				//xj
				//xɉ
				'xɉansar',
				//xk
				//xl
				'xlaka', 'buxlar',
				//xm
				'egoixmo',
				//xn
				'maxnada', 'xnegar',
				//xñ
				'xñakar', 'orexñaŧa',
				//xp
				//xr
				'xraɉonar',
				//xs
				//xt
				//xŧ
				//xv
				'xvodar',

				//kontro
				'kontroexenpio', 'kontroindikar',
				//ekstra
				'ekstra', 'ekstrasolar', 'ekstraeuropèo', 'ekstrauterin', 'ekstraospedalièr',
				//para
				'parabankario', 'paraetimolòxego', 'paraòci', 'paraurti',
				//òpto
				'optoeletrònego', 'optografía',
				//anti
				'antilèrxego', 'antiatòmego',
				//pne
				'dispnèa', 'dispnòiko',
				//bio
				'biolòxego', 'bioastronàuta', 'bioelètrego', 'bioenerxía',
				//pre
				'prealarme', 'preexame',
				//diphtongs
				'viòla', 'indian', 'piòlo', 'lengua', 'kuesto', 'xàino', 'piaxe', 'pien', 'dietro', 'ocai', 'matèria', 'pinguin', 'euròpa', 'piuma', 'foiba',
				//others
				'abnegathion', 'àbside', 'drakma', 'tèknika', 'iks', 'tungstèno', 'pnèumo', 'psikoloxía', 'aritmètega', 'etnía', 'strako', 'baston'
			];
words = ['kaxa', 'jutar', 'pàuxa', 'piaŧa', 'auguri', 'àuguri', 'grant', 'inbrijar', 'autoirònego', 'aŧion', 'saltar',
	'lontan', 'finlandia', 'gronda', 'injasar', 'serpente', 'kospirar', 'kosto', 'kostrénxer', 'despresar', 'bastanŧa', 'destrikar', 'peskar',
	'maèstra', 'dexmentegà', 'ciklixmo', 'strako', 'scantixo', 'sfexa', 'stabia', 'stranbo', 'skòpo', 'xbaro', 'xbrigar', 'xbèrla', 'submontano',
	'abnegasion', 'àbside', 'tèknika', 'iks', 'etnía', 'ipnoxi', 'biopsía', 'ritmo', 'aritmètega', 'tungstèno', 'poexía', 'gas', 'alfa'];
words = ['maèstro', 'poèta', 'paexe', 'mie', 'buxía', 'siar', 'paura', 'diurno', 'suino'];
			words.forEach(function(word){
				var hypenatedWord = hypenate(word);
				var syllabatedWord = syllabatePhonematicAndJoin(word);

				console.log('= ' + hypenatedWord + ' / ' + syllabatedWord);
			});
		});
	</script>
</head>

<body>
</body>
</html>
